const { MessageAttachment, Message } = require('discord.js'),
  AmeClient = require('amethyste-api'),
  Client = require('../../../struct/Client');

module.exports = {
  name: 'pixelize',
  aliases: [],
  description: '',
  category: 'misc',
  utilisation: '{prefix}pixelize',
  cooldown: 5,
  guildOnly: false,
  ownerOnly: false,
  adminOnly: false,
  nsfw: false,
  permissions: [],
  clientPermissions: ['VIEW_CHANNEL', 'SEND_MESSAGES', 'ATTACH_FILES'],
  string: [],
  /**
   * @param {Client} client
   * @param {Message} message
   * @param {String[]} args
   */
  async execute(client, message, args) {
    const AmeAPI = new AmeClient(client.config.amethyste.client);
    {
      const User =
        (await message.mentions.members.first()) ||
        message.guild.members.cache.get(args[0]) ||
        message.guild.members.cache.find(
          (r) => r.user.username.toLowerCase().startsWith(args.join(' ').toLowerCase())
        ) ||
        message.guild.members.cache.find(
          (r) => r.displayName.toLowerCase().startsWith(args.join(' ').toLowerCase())
        );
      if (User) {
        const number = parseInt(args[1]);
        if (
          [][
            (![] + [])[+[]] +
              (![] + [])[!+[] + !+[]] +
              (![] + [])[+!+[]] +
              (!![] + [])[+[]]
          ][
            ([][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ] + [])[!+[] + !+[] + !+[]] +
              (!![] +
                [][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ])[+!+[] + [+[]]] +
              ([][[]] + [])[+!+[]] +
              (![] + [])[!+[] + !+[] + !+[]] +
              (!![] + [])[+[]] +
              (!![] + [])[+!+[]] +
              ([][[]] + [])[+[]] +
              ([][
                (![] + [])[+[]] +
                  (![] + [])[!+[] + !+[]] +
                  (![] + [])[+!+[]] +
                  (!![] + [])[+[]]
              ] + [])[!+[] + !+[] + !+[]] +
              (!![] + [])[+[]] +
              (!![] +
                [][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ])[+!+[] + [+[]]] +
              (!![] + [])[+!+[]]
          ](
            (!![] + [])[+!+[]] +
              (!![] + [])[!+[] + !+[] + !+[]] +
              (!![] + [])[+[]] +
              ([][[]] + [])[+[]] +
              (!![] + [])[+!+[]] +
              ([][[]] + [])[+!+[]] +
              (+[![]] +
                [][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ])[+!+[] + [+!+[]]] +
              (!![] + [])[!+[] + !+[] + !+[]] +
              (+(!+[] + !+[] + !+[] + [+!+[]]))[
                (!![] + [])[+[]] +
                  (!![] +
                    [][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ])[+!+[] + [+[]]] +
                  ([] + [])[
                    ([][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ] + [])[!+[] + !+[] + !+[]] +
                      (!![] +
                        [][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ])[+!+[] + [+[]]] +
                      ([][[]] + [])[+!+[]] +
                      (![] + [])[!+[] + !+[] + !+[]] +
                      (!![] + [])[+[]] +
                      (!![] + [])[+!+[]] +
                      ([][[]] + [])[+[]] +
                      ([][
                        (![] + [])[+[]] +
                          (![] + [])[!+[] + !+[]] +
                          (![] + [])[+!+[]] +
                          (!![] + [])[+[]]
                      ] + [])[!+[] + !+[] + !+[]] +
                      (!![] + [])[+[]] +
                      (!![] +
                        [][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ])[+!+[] + [+[]]] +
                      (!![] + [])[+!+[]]
                  ][
                    ([][[]] + [])[+!+[]] +
                      (![] + [])[+!+[]] +
                      ((+[])[
                        ([][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ] + [])[!+[] + !+[] + !+[]] +
                          (!![] +
                            [][
                              (![] + [])[+[]] +
                                (![] + [])[!+[] + !+[]] +
                                (![] + [])[+!+[]] +
                                (!![] + [])[+[]]
                            ])[+!+[] + [+[]]] +
                          ([][[]] + [])[+!+[]] +
                          (![] + [])[!+[] + !+[] + !+[]] +
                          (!![] + [])[+[]] +
                          (!![] + [])[+!+[]] +
                          ([][[]] + [])[+[]] +
                          ([][
                            (![] + [])[+[]] +
                              (![] + [])[!+[] + !+[]] +
                              (![] + [])[+!+[]] +
                              (!![] + [])[+[]]
                          ] + [])[!+[] + !+[] + !+[]] +
                          (!![] + [])[+[]] +
                          (!![] +
                            [][
                              (![] + [])[+[]] +
                                (![] + [])[!+[] + !+[]] +
                                (![] + [])[+!+[]] +
                                (!![] + [])[+[]]
                            ])[+!+[] + [+[]]] +
                          (!![] + [])[+!+[]]
                      ] + [])[+!+[] + [+!+[]]] +
                      (!![] + [])[!+[] + !+[] + !+[]]
                  ]
              ](!+[] + !+[] + !+[] + [!+[] + !+[]]) +
              (![] + [])[+!+[]] +
              (![] + [])[!+[] + !+[]]
          )()(
            ([![]] + [][[]])[+!+[] + [+[]]] +
              (![] + [])[!+[] + !+[] + !+[]] +
              (+[![]] + [])
          )(number)
        )
          return message.channel.send(this.config.string[1]);
        if (number < 1) return message.channel.send(this.config.string[2]);
        if (number > 50) return message.channel.send(this.config.string[2]);
        let m = await message.channel.send(message.guild.i18n.__mf("common.wait"));
        const buffer = await AmeAPI.generate('pixelize', {
          url: User.user.displayAvatarURL({ format: 'png', size: 2048 }),
          pixelize: number,
        });
        const attachment = new MessageAttachment(buffer, 'pixelize.png');
        m.delete({ timeout: 3000 });
        message.channel.send(attachment);
      } else {
        const number = parseInt(args[0]);
        if (
          [][
            (![] + [])[+[]] +
              (![] + [])[!+[] + !+[]] +
              (![] + [])[+!+[]] +
              (!![] + [])[+[]]
          ][
            ([][
              (![] + [])[+[]] +
                (![] + [])[!+[] + !+[]] +
                (![] + [])[+!+[]] +
                (!![] + [])[+[]]
            ] + [])[!+[] + !+[] + !+[]] +
              (!![] +
                [][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ])[+!+[] + [+[]]] +
              ([][[]] + [])[+!+[]] +
              (![] + [])[!+[] + !+[] + !+[]] +
              (!![] + [])[+[]] +
              (!![] + [])[+!+[]] +
              ([][[]] + [])[+[]] +
              ([][
                (![] + [])[+[]] +
                  (![] + [])[!+[] + !+[]] +
                  (![] + [])[+!+[]] +
                  (!![] + [])[+[]]
              ] + [])[!+[] + !+[] + !+[]] +
              (!![] + [])[+[]] +
              (!![] +
                [][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ])[+!+[] + [+[]]] +
              (!![] + [])[+!+[]]
          ](
            (!![] + [])[+!+[]] +
              (!![] + [])[!+[] + !+[] + !+[]] +
              (!![] + [])[+[]] +
              ([][[]] + [])[+[]] +
              (!![] + [])[+!+[]] +
              ([][[]] + [])[+!+[]] +
              (+[![]] +
                [][
                  (![] + [])[+[]] +
                    (![] + [])[!+[] + !+[]] +
                    (![] + [])[+!+[]] +
                    (!![] + [])[+[]]
                ])[+!+[] + [+!+[]]] +
              (!![] + [])[!+[] + !+[] + !+[]] +
              (+(!+[] + !+[] + !+[] + [+!+[]]))[
                (!![] + [])[+[]] +
                  (!![] +
                    [][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ])[+!+[] + [+[]]] +
                  ([] + [])[
                    ([][
                      (![] + [])[+[]] +
                        (![] + [])[!+[] + !+[]] +
                        (![] + [])[+!+[]] +
                        (!![] + [])[+[]]
                    ] + [])[!+[] + !+[] + !+[]] +
                      (!![] +
                        [][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ])[+!+[] + [+[]]] +
                      ([][[]] + [])[+!+[]] +
                      (![] + [])[!+[] + !+[] + !+[]] +
                      (!![] + [])[+[]] +
                      (!![] + [])[+!+[]] +
                      ([][[]] + [])[+[]] +
                      ([][
                        (![] + [])[+[]] +
                          (![] + [])[!+[] + !+[]] +
                          (![] + [])[+!+[]] +
                          (!![] + [])[+[]]
                      ] + [])[!+[] + !+[] + !+[]] +
                      (!![] + [])[+[]] +
                      (!![] +
                        [][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ])[+!+[] + [+[]]] +
                      (!![] + [])[+!+[]]
                  ][
                    ([][[]] + [])[+!+[]] +
                      (![] + [])[+!+[]] +
                      ((+[])[
                        ([][
                          (![] + [])[+[]] +
                            (![] + [])[!+[] + !+[]] +
                            (![] + [])[+!+[]] +
                            (!![] + [])[+[]]
                        ] + [])[!+[] + !+[] + !+[]] +
                          (!![] +
                            [][
                              (![] + [])[+[]] +
                                (![] + [])[!+[] + !+[]] +
                                (![] + [])[+!+[]] +
                                (!![] + [])[+[]]
                            ])[+!+[] + [+[]]] +
                          ([][[]] + [])[+!+[]] +
                          (![] + [])[!+[] + !+[] + !+[]] +
                          (!![] + [])[+[]] +
                          (!![] + [])[+!+[]] +
                          ([][[]] + [])[+[]] +
                          ([][
                            (![] + [])[+[]] +
                              (![] + [])[!+[] + !+[]] +
                              (![] + [])[+!+[]] +
                              (!![] + [])[+[]]
                          ] + [])[!+[] + !+[] + !+[]] +
                          (!![] + [])[+[]] +
                          (!![] +
                            [][
                              (![] + [])[+[]] +
                                (![] + [])[!+[] + !+[]] +
                                (![] + [])[+!+[]] +
                                (!![] + [])[+[]]
                            ])[+!+[] + [+[]]] +
                          (!![] + [])[+!+[]]
                      ] + [])[+!+[] + [+!+[]]] +
                      (!![] + [])[!+[] + !+[] + !+[]]
                  ]
              ](!+[] + !+[] + !+[] + [!+[] + !+[]]) +
              (![] + [])[+!+[]] +
              (![] + [])[!+[] + !+[]]
          )()(
            ([![]] + [][[]])[+!+[] + [+[]]] +
              (![] + [])[!+[] + !+[] + !+[]] +
              (+[![]] + [])
          )(number)
        )
          return message.channel.send(message.guild.i18n.__mf("pixelize.valid_number"));
        if (number < 1) return message.channel.send(message.guild.i18n.__mf("pixelize.insert_number"));
        if (number > 50) return message.channel.send(message.guild.i18n.__mf("pixelize.insert_number"));
        let m = await message.channel.send(message.guild.i18n.__mf("common.wait"));
        const buffer = await AmeAPI.generate('pixelize', {
          url: message.author.displayAvatarURL({ format: 'png', size: 2048 }),
          pixelize: number,
        });
        const attachment = new MessageAttachment(buffer, 'pixelize.png');
        m.delete({ timeout: 3000 });
        message.channel.send(attachment);
      }
    }
  },
};
